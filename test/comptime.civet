{ testCase, throws } from ./helper.civet
{ compile } from ../source/main.civet
assert from assert

describe "comptime", ->
  testCase """
    statement with indented block
    ---
    comptime
      x := 5
      x * x
    ---

  """

  testCase """
    one-line statement
    ---
    comptime x := 5
    ---

  """

  it "statement has side effect", =>
    global.outside = 0
    compile "comptime global.outside = 7"
    assert.equal global.outside, 7

  testCase """
    one-line expression
    ---
    value := comptime 1+2
    ---
    const value = 3
  """

  testCase """
    expression with indented block
    ---
    value := comptime
      x := 5
      x * x
    ---
    const value = 25
  """
