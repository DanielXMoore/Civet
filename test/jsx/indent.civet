{testCase, throws} from ../helper.civet

describe "Indentation-based JSX", ->
  testCase """
    no children
    ---
    return
      <div>
    console.log 'unreachable'
    ---
    return
      <div />
    console.log('unreachable')
  """

  testCase """
    indentation for every tag
    ---
    return
      <div>
        <b>
          Bold
        <i>
          Italic
    console.log 'unreachable'
    ---
    return
      <div>
        <b>
          Bold
        </b>
        <i>
          Italic
        </i>
    </div>
    console.log('unreachable')
  """

  testCase """
    not actually indentation
    ---
    return
      <div>
    console.log 'unreachable'
      </div>
    ---
    return
      <div>
    console.log 'unreachable'
      </div>
  """

  testCase """
    indented fragments
    ---
    return
      <>
        <b>
          Bold
        <i>
          Italic
    console.log 'unreachable'
    ---
    return
      <>
        <b>
          Bold
        </b>
        <i>
          Italic
        </i>
    </>
    console.log('unreachable')
  """

  testCase """
    outer indentation, inner closed tags
    ---
    return
      <div>
        <b>Bold</b>
        <i>Italic</i>
    console.log 'unreachable'
    ---
    return
      <div>
        <b>Bold</b>
        <i>Italic</i>
    </div>
    console.log('unreachable')
  """

  testCase """
    inner indentation, outer closed tags
    ---
    return
      <div>
        <b>
          Bold
        <i>
          Italic
      </div>
    console.log 'unreachable'
    ---
    return
      <div>
        <b>
          Bold
    </b>
        <i>
          Italic
    </i>
      </div>
    console.log('unreachable')
  """

  testCase """
    fragment of same-level tags
    ---
    <>
      <div>
      <b>
      <i>
    ---
    <>
      <div />
      <b />
      <i />
    </>
  """

  testCase """
    array of same-level tags
    ---
    [
      <div>
      <b>
      <i>
    ]
    ---
    [
      <div />,
      <b />,
      <i />
    ]
  """

  testCase """
    array of same-level tags with one closing
    ---
    [
      <div>
      <div>
      </div>
      <b>
    ]
    ---
    [
      <div />,
      <div>
      </div>,
      <b />
    ]
  """

  testCase """
    array with indented closed tags
    ---
    [
      <div>
        <b>Bold</b>
        <i>Bold</i>
      <div>
    ]
    ---
    [
      <div>
        <b>Bold</b>
        <i>Bold</i>
      </div>,
      <div />
    ]
  """

  testCase """
    SolidJS example from https://playground.solidjs.com/
    ---
    function Counter()
      [count, setCount] := createSignal 1
      increment := -> setCount count() + 1
      <button type="button" onClick={increment}>
        {count()}
    ---
    function Counter() {
      const [count, setCount] = createSignal(1)
      function increment () { return setCount(count() + 1) }
      return <button type="button" onClick={increment}>
        {count()}
      </button>
    }
  """

  testCase """
    SolidJS example from https://www.solidjs.com/tutorial/introduction_jsx
    ---
    return
      <>
        <div>
          Hello {name}!
        {svg}
    ---
    return
      <>
        <div>
          Hello {name}!
        </div>
        {svg}
    </>
  """
