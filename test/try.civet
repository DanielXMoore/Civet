{testCase} from ./helper.civet

describe "try", ->
  testCase """
    basic
    ---
    try
      x()
    catch y
      console.log y
    ---
    try {
      x();
    }
    catch (y) {
      console.log(y);
    };
  """

  testCase """
    implied catch
    ---
    try
      x()
    ---
    try {
      x();
    } catch(e) {};
  """

  testCase """
    catch with no parameter
    ---
    try
      x()
    catch
      console.log 'error'
    ---
    try {
      x();
    }
    catch {
      console.log('error');
    };
  """

  testCase """
    finally
    ---
    try
      x()
    finally
      console.log y
    ---
    try {
      x();
    }
    finally {
      console.log(y);
    };
  """

  testCase """
    single line
    ---
    try x()
    catch y
      console.log y
    ---
    try { x() }
    catch (y) {
      console.log(y);
    };
  """

  // This should match CoffeeScript where the postfix conditional is inside the try block
  describe.skip "TODO", ->
    testCase """
      another single line
      ---
      try a = 7 if x()
      ---
      try { if (x()) { a = 7 } } catch(e) {};
    """
